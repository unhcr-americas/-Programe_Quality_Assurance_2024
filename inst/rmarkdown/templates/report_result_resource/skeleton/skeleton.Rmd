---
params:
  year: 2023
  activityInfoTable: "cdn6y40lm87wi522"
  region: "Americas"
title: "Result Based Management - Resource Vs Results"
subtitle: "Regional Evaluative Review - `r params$region` | `r params$year`"
date: "`r format(Sys.Date(),  '%d %B %Y')`"
output:
  unhcrdown::pptx_slides
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.cap = TRUE)
library(officedown)
library(unhcrthemes)
library(ggplot2)
library(rvg)
library(tidyverse)
library(scales)
library(lubridate)
library(fontawesome)
library(readxl)
library(FactoMineR) 
library(factoextra) 
library(directlabels)
library(ggforce)
library(ggtext)
library(corrplot)
library(ProgQA)

options(scipen = 999) # turn-off scientific notation like 1e+48
set.seed(1)
extrafont::loadfonts(quiet=TRUE)
# turn off the automatic use of showtext functionality, so that the dml function can works properly
showtext::showtext_auto(FALSE) 
# Loading data
data <- ProgQA::prepare_qa_data(activityInfo = params$activityInfoTable)
budget <- readxl::read_excel( here::here("data-raw", "4.6.1_Budget_Download.xlsx"),  skip = 1)|>
  janitor::clean_names()


```

---

# Introduction

The review of results measured through indicators and the share of financial resources spent on the outcome linked to the indicator aims at determining the efficiency and effectiveness of the program's implementation and resource allocation:

  * By comparing outcomes against resource allocation, it identifies areas of success and areas needing improvement within the program. This allows for informed decision-making to optimize resource allocation.

  * Through evaluating the correlation between resource allocation and outcomes, valuable insights are gained into what strategies are most effective in achieving desired results. This knowledge can inform future program design and implementation, leading to better outcomes over time.
  

---

# Approach: An attempt to look at Value for Money...

This report include some exploration from the provisional data internally available in  [results.unhcr.org - report -2.2.1 & 4.6.1]( https://results.unhcr.org). This includes information for each operation on indicator actual value, baseline and target and by outcome, as well the spent __WOL__ (_Within Operating Level, aka the spending authority for ABOD and OPS assigned by HQs/DFAM_) during the same year. 

Note that the same data is then published publicly in [IATI](https://reporting.unhcr.org/iati-international-aid-transparency-initiative) later in the year, allowing for the same analysis to be done by donors later on.

__Allocation Share__  are created to allow for comparison across operations with different budgets.  

---

# Reviewing Resource Usage across the region

Because of the diversity of operations size in the region, _blindly comparing raw figures_ is unlikely to yield meaningful insights... __but__ we can open up questions: 

 1. How __share of operation resources__ allocated to each potential outcome looks like within the region ? 
 
 2. Is there any unexpected __patterns__ of budget allocation within?
 
 3. Can we identify "__Operation profiles__" based on how the budget is created? 
 

--- 

```{r ph=officer::ph_location_fullsize()}

budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation ) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) 



budget_outcome  |>
  ggplot2::ggplot( ggplot2::aes( x = cost_usd, y = reorder( operation , cost_usd) )) +
  ggplot2::geom_col( fill = "#0072BC") +
  ## Position label differently in the bar in white - outside bar in black
  ggplot2::geom_text(
      data = subset(budget_outcome, cost_usd < max(cost_usd) / 1.5),
      ggplot2::aes(  x = cost_usd, y = reorder( operation , cost_usd),
                      label = label_number(accuracy = 2,
                             scale_cut = cut_short_scale())(cost_usd) ),
      hjust = -0.1 ,  vjust = 0.5, colour = "black", size = 4    ) +
  ggplot2::geom_text(
      data = subset(budget_outcome, cost_usd >= max(cost_usd) / 1.5),
      ggplot2::aes( x = cost_usd, y = reorder( operation , cost_usd),
                    label = label_number(accuracy = 3,
                             scale_cut = cut_short_scale())(cost_usd)),
      hjust = 1.1 , vjust = 0.5, colour = "white",  size = 4) +
      
  ggplot2::scale_y_discrete(name = NULL, 
                   expand = c(0, 0.2)) + 
  ggplot2::scale_x_continuous(labels = scales::label_number(suffix = "$",
                                                            accuracy = 1,
                                                   scale_cut = scales::cut_si(""))) +
  unhcrthemes::theme_unhcr(grid = "X", axis = "X",
                           axis_title = "X", font_size = 18,
                           legend = FALSE) +
  ggplot2::labs(
    title = paste0( "Within Operating Level | 2023"),
    subtitle =   "By Operation" ,
    x = "",  y = "",
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion" )   -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 

```{r ph=officer::ph_location_fullsize()}

budget_account <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  # dplyr::filter(plan %in% c("Argentina MCO", "Brazil ABC" ,
  #                           "Regional Bureau AME ABC",
  #                           "Canada ABC", "Chile",    "Colombia ABC",
  #                           "Costa Rica ABC", "Ecuador ABC"  ,
  #                           "El  Salvador ABC" ,"Guatemala ABC" ,
  #                           "Honduras ABC" ,"Mexico ABC" ,
  #                           "Peru ABC"  , "United States MCO"  ,"Venezuela ABC"      )) |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                "Brazil ABC",
                                "Canada ABC" ,
                               "Colombia ABC" ,
                                "Costa Rica ABC",
                                "Ecuador ABC",
                                "El Salvador ABC",
                                "Guatemala ABC" ,
                                "Honduras ABC",
                                "Mexico ABC",
                               # "Other Operations in Americas ABC"
                               "Panama MCO ABC",
                               "Peru ABC",
                              # "Regional Activities AME ABC"
                                "Regional Bureau AME ABC",
                                "United States MCO ABC",
                                "Venezuela ABC"            )) |>
  dplyr::group_by(   budget_category, account) |> # plan,
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(   budget_category ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  dplyr::ungroup() |>
  dplyr::mutate( account = forcats::fct_lump_n(
    f = account,
    n = 6,  #### Parameter
    w = percent,
    other_level = 'Other Account lumped together',
    ties.method = "last")    )|>
  dplyr::mutate( account = dplyr::if_else( is.na(account), budget_category, account )) |>
  dplyr::group_by(   account) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE))  



budget_account  |>
  ggplot2::ggplot( ggplot2::aes( x = cost_usd, y = reorder( account , cost_usd) )) +
  ggplot2::geom_col( fill = "#0072BC") +
  ## Position label differently in the bar in white - outside bar in black
  ggplot2::geom_text(
      data = subset(budget_account, cost_usd < max(cost_usd) / 1.5),
      ggplot2::aes(  x = cost_usd, y = reorder( account , cost_usd),
                      label = label_number(accuracy = 2,
                             scale_cut = cut_short_scale())(cost_usd) ),
      hjust = -0.1 ,  vjust = 0.5, colour = "black", size = 4    ) +
  ggplot2::geom_text(
      data = subset(budget_account, cost_usd >= max(cost_usd) / 1.5),
      ggplot2::aes( x = cost_usd, y = reorder(account , cost_usd),
                    label = label_number(accuracy = 2,
                             scale_cut = cut_short_scale())(cost_usd)),
      hjust = 1.1 , vjust = 0.5, colour = "white",  size = 4) +
      
  ggplot2::scale_y_discrete(name = NULL, 
                   expand = c(0, 0.2)) + 
  ggplot2::scale_x_continuous(labels = scales::label_number(suffix = "$",
                                                            accuracy = 1,
                                                   scale_cut = scales::cut_si(""))) +
  unhcrthemes::theme_unhcr(grid = "X", axis = "X",
                           axis_title = "X", font_size = 18,
                           legend = FALSE) +
  ggplot2::labs(
    title = paste0( "Within Operating Level | 2023"),
    subtitle =   "By Account, Staff & ABOD" ,
    x = "",  y = "",
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion" )   -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

```{r ph=officer::ph_location_fullsize()}
budget_account <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  # dplyr::filter(plan %in% c("Argentina MCO", "Brazil ABC" ,
  #                           "Regional Bureau AME ABC",
  #                           "Canada ABC", "Chile",    "Colombia ABC",
  #                           "Costa Rica ABC", "Ecuador ABC"  ,
  #                           "El  Salvador ABC" ,"Guatemala ABC" ,
  #                           "Honduras ABC" ,"Mexico ABC" ,
  #                           "Peru ABC"  , "United States MCO"  ,"Venezuela ABC"      )) |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                "Brazil ABC",
                                "Canada ABC" ,
                               "Colombia ABC" ,
                                "Costa Rica ABC",
                                "Ecuador ABC",
                                "El Salvador ABC",
                                "Guatemala ABC" ,
                                "Honduras ABC",
                                "Mexico ABC",
                               # "Other Operations in Americas ABC"
                               "Panama MCO ABC",
                               "Peru ABC",
                              # "Regional Activities AME ABC"
                                "Regional Bureau AME ABC",
                                "United States MCO ABC",
                                "Venezuela ABC"            )) |>
  dplyr::group_by(operation_code, operation,  budget_category, account) |> # plan,
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation,   budget_category ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  dplyr::ungroup() |>
  dplyr::mutate( account = forcats::fct_lump_n(
    f = account,
    n = 6,  #### Parameter
    w = percent,
    other_level = 'Other Account lumped together',
    ties.method = "last")    )|>
  dplyr::mutate( account = dplyr::if_else( is.na(account), budget_category, account )) |>
  dplyr::group_by(operation_code, operation,  account) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation ) |>
  dplyr::mutate( percent = round(cost_usd / sum(cost_usd, na.am = TRUE) * 100,2) )


#levels(as.factor(budget_account$account))
#table(budget_account$account, useNA = "ifany")

budget_account  |>
  ggplot2::ggplot( ggplot2::aes( x = percent, y = reorder( account, percent) )) +
  ggplot2::geom_col( fill = "#0072BC") +
  ggplot2::facet_wrap(~ operation, 
       labeller = ggplot2::labeller(operation = ggplot2::label_wrap_gen(20)) ) +
  ggplot2::scale_x_continuous( label =  scales::label_number(accuracy = 1,
                                                             suffix = "%",
             scale_cut = scales::cut_short_scale()) ) +
  unhcrthemes::theme_unhcr(grid = "X", axis = "X",
                           axis_title = "X", font_size = 18,
                           axis_text_size = 9,
                           strip_text_size = rel(0.6),
                           legend = FALSE)+
  ggplot2::labs(
    title = paste0( "Within Operating Level | 2023"),
    subtitle =   "By Account & Operation" ,
    x = "",
    y = "",
    caption = "Source: results.unhcr.org 4.6.1" )  -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 

```{r ph=officer::ph_location_fullsize()}
budget_account <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  # dplyr::filter(plan %in% c("Argentina MCO", "Brazil ABC" ,
  #                           "Regional Bureau AME ABC",
  #                           "Canada ABC", "Chile",    "Colombia ABC",
  #                           "Costa Rica ABC", "Ecuador ABC"  ,
  #                           "El  Salvador ABC" ,"Guatemala ABC" ,
  #                           "Honduras ABC" ,"Mexico ABC" ,
  #                           "Peru ABC"  , "United States MCO"  ,"Venezuela ABC"      )) |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                "Brazil ABC",
                                "Canada ABC" ,
                               "Colombia ABC" ,
                                "Costa Rica ABC",
                                "Ecuador ABC",
                                "El Salvador ABC",
                                "Guatemala ABC" ,
                                "Honduras ABC",
                                "Mexico ABC",
                               # "Other Operations in Americas ABC"
                               "Panama MCO ABC",
                               "Peru ABC",
                              # "Regional Activities AME ABC"
                                "Regional Bureau AME ABC",
                                "United States MCO ABC",
                                "Venezuela ABC"            )) |>
  dplyr::group_by(operation_code, operation,  budget_category, account) |> # plan,
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation,   budget_category ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  dplyr::ungroup() |>
  dplyr::mutate( account = forcats::fct_lump_n(
    f = account,
    n = 6,  #### Parameter
    w = percent,
    other_level = 'Other Account lumped together',
    ties.method = "last")    )|>
  dplyr::mutate( account = dplyr::if_else( is.na(account), budget_category, account )) |>
  dplyr::group_by(operation_code, operation,  account) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation ) |>
  dplyr::mutate( percent = round(cost_usd / sum(cost_usd, na.am = TRUE) * 100,2) )


#levels(as.factor(budget_account$account))
#table(budget_account$account, useNA = "ifany")


budget_account  |>
  ggplot2::ggplot( ggplot2::aes( x = percent, y = reorder(operation , percent) )) +
  ggplot2::geom_col( fill = "#0072BC") +
  ggplot2::facet_wrap(~ account, 
       labeller = ggplot2::labeller(account = ggplot2::label_wrap_gen(20))) +
  ggplot2::scale_x_continuous( label =  scales::label_number(accuracy = 1,
                                                             suffix = "%",
                                                             scale_cut = scales::cut_short_scale()) ) +
  unhcrthemes::theme_unhcr(grid = "X", axis = "X",
                           axis_title = "X", font_size = 18,
                           axis_text_size = 9,
                           strip_text_size = rel(0.6),
                           legend = FALSE)+
  ggplot2::labs(
    title = paste0( "Within Operating Level | 2023"),
    subtitle =   "By  Operation & Account" ,
    x = "",
    y = "",
    caption = "Source: results.unhcr.org 4.6.1" )  -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```
 



--- 


```{r ph=officer::ph_location_fullsize()}

budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(outcome_area ) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(outcome_area  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) 



budget_outcome  |>
  ggplot2::ggplot( ggplot2::aes( x = cost_usd, y = reorder( outcome_area , cost_usd) )) +
  ggplot2::geom_col( fill = "#0072BC") +
  ## Position label differently in the bar in white - outside bar in black
  ggplot2::geom_text(
      data = subset(budget_outcome, cost_usd < max(cost_usd) / 1.5),
      ggplot2::aes(  x = cost_usd, y = reorder(outcome_area , cost_usd),
                      label = label_number(accuracy = 2,
                             scale_cut = cut_short_scale())(cost_usd) ),
      hjust = -0.1 ,  vjust = 0.5, colour = "black", size = 4    ) +
  ggplot2::geom_text(
      data = subset(budget_outcome, cost_usd >= max(cost_usd) / 1.5),
      ggplot2::aes( x = cost_usd, y = reorder( outcome_area , cost_usd),
                    label = label_number(accuracy = 2,
                             scale_cut = cut_short_scale())(cost_usd)),
      hjust = 1.1 , vjust = 0.5, colour = "white",  size = 4) +
      
  ggplot2::scale_y_discrete(name = NULL, 
                   expand = c(0, 0.2)) + 
  ggplot2::scale_x_continuous(labels = scales::label_number(suffix = "$",
                                                            accuracy = 1,
                                                   scale_cut = scales::cut_si(""))) +
  unhcrthemes::theme_unhcr(grid = "X", axis = "X",
                           axis_title = "X", font_size = 18,
                           legend = FALSE) +
  ggplot2::labs(
    title = paste0( "Within Operating Level | 2023"),
    subtitle =   "By Outcome" ,
    x = "",  y = "",
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion" )   -> mygg 
showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 


```{r ph=officer::ph_location_fullsize()}
 
# ECU & PER & BRA
# COL & MEX & VEN
# PAN MC & ARG MC
# SLV & HND & GTM
# CAN & USA MC

# South of Latin America
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  # dplyr::filter(operation %in% c("Argentina MCO ABC",  
  #                               "Ecuador ABC",
  #                               "Peru ABC" )) 
  dplyr::filter(operation %in% c("Brazil ABC", 
                                "Ecuador ABC",
                                "Peru ABC" )) 
budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
 
# North of Latin America
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  # dplyr::filter(operation %in% c( "Brazil ABC",
  #                              "Colombia ABC",  
  #                                "Venezuela ABC"))  
  dplyr::filter(operation %in% c( "Mexico ABC",
                               "Colombia ABC",  
                                 "Venezuela ABC"))  
budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))  
```


--- 


```{r ph=officer::ph_location_fullsize()}
 
# North of Latin America
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
 # dplyr::filter(operation %in%  c("Costa Rica ABC",  "Mexico ABC",  "Panama MCO ABC")) 
  dplyr::filter(operation %in%  c(  "Argentina MCO ABC",  "Panama MCO ABC")) 

 

budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))  
```

--- 


```{r ph=officer::ph_location_fullsize()}
 
# North of Latin America
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
  dplyr::filter(operation %in%  c( "El Salvador ABC", "Honduras ABC", "Guatemala ABC" )) 

budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

```{r ph=officer::ph_location_fullsize()}
 
# North of Latin America
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |>
 # dplyr::filter(operation %in%   c("Canada ABC", "United States MCO ABC")) 
 dplyr::filter(operation %in%   c("Canada ABC", "United States MCO ABC", "Costa Rica ABC" )) 
  

budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 

```{r ph=officer::ph_location_fullsize()}
 
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                 "Brazil ABC",
                                 "Canada ABC" ,
                                 "Colombia ABC" ,
                                 "Costa Rica ABC",
                                 "Ecuador ABC",
                                 "El Salvador ABC",
                                 "Guatemala ABC" ,
                                 "Honduras ABC",
                                 "Mexico ABC",
                                 # "Other Operations in Americas ABC"
                                 "Panama MCO ABC",
                                 "Peru ABC",
                                 # "Regional Activities AME ABC"
                                 "Regional Bureau AME ABC",
                                 "United States MCO ABC",
                                 "Venezuela ABC"            )) |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) )

budget_outcome |> 
 ggplot2::ggplot()  +
  ggplot2::aes(
    x = outcome_area,
    y = operation,
    fill = percent
  ) +
  geom_tile() +
  geom_text(aes(label = paste0(round(percent*100,1),"%") ), 
            color = "grey50", 
            size = 3) +
  scale_fill_viridis_c(option = "plasma", direction = -1) +
  labs(
    x = " ",
    y = " ",
    title = "Comparison of Resources Allocations",
    subtitle = "Between Outcome and Operation | 2023",
    fill = "Percent of WOL",
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  unhcrthemes::theme_unhcr(font_size = 10) +
  theme(legend.position = "none",
        axis.text.x=element_text(angle=40,hjust=1))  -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 

```{r ph=officer::ph_location_fullsize()}
 
# Spread by Outcome
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                 "Brazil ABC",
                                 "Canada ABC" ,
                                 "Colombia ABC" ,
                                 "Costa Rica ABC",
                                 "Ecuador ABC",
                                 "El Salvador ABC",
                                 "Guatemala ABC" ,
                                 "Honduras ABC",
                                 "Mexico ABC",
                                 # "Other Operations in Americas ABC"
                                 "Panama MCO ABC",
                                 "Peru ABC",
                                 # "Regional Activities AME ABC"
                                 "Regional Bureau AME ABC",
                                 "United States MCO ABC",
                                 "Venezuela ABC"            )) |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) )

budget_outcome |> 
 ggplot2::ggplot() +
  ggplot2::aes(x = operation, y = percent) +
  geom_boxplot(fill = unhcrthemes::unhcr_pal(n = 1, "pal_blue")) +
  labs(
    x = "",
    y = "% of WOL ",
    title = "How evenly are financial resources allocated among programmatic outcomes?",
    subtitle =  stringr::str_wrap("By Operation | 2023 - A boxplot is a way to show how data is spread out by drawing a box with lines that represent the minimum, maximum, and middle values of a set of numbers", 110),
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
  coord_flip() + 
  scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" )  -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

```{r ph=officer::ph_location_fullsize()}

                                 

# Spread by Country 
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                 "Brazil ABC",
                                 "Canada ABC" ,
                                 "Colombia ABC" ,
                                 "Costa Rica ABC",
                                 "Ecuador ABC",
                                 "El Salvador ABC",
                                 "Guatemala ABC" ,
                                 "Honduras ABC",
                                 "Mexico ABC",
                                 # "Other Operations in Americas ABC"
                                 "Panama MCO ABC",
                                 "Peru ABC",
                                 # "Regional Activities AME ABC"
                                 "Regional Bureau AME ABC",
                                 "United States MCO ABC",
                                 "Venezuela ABC"            )) |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) )

budget_outcome |> 
 ggplot2::ggplot() +
  aes(x = outcome_area, y = percent) +
  geom_boxplot(fill = unhcrthemes::unhcr_pal(n = 1, "pal_blue")) +
  labs(
    x = "% of WOL",
    y = " ",
    title = "How evenly are financial resources allocated among Operations?",
    subtitle = stringr::str_wrap("By programmatic outcomes | 2023 - A boxplot is a way to show how data is spread out by drawing a box with lines that represent the minimum, maximum, and middle values of a set of numbers.)", 110),
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +

  coord_flip() + 
  scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" )   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```



---

#  Can we Identify distinct Operation Profiles based on Resource Allocation Strategy?

For this we combine all the information above to extract the most meaningful "_factors_" and use those to have an holistic understanding of resource allocation.

Different outcome resource allocation are grouped together into a few key themes (the factor)

This analysis is called PCA for __Principal Component Analysis__. PCA helps in simplifying all data from different countries' operations in order identifies the main trends or patterns that  group different countries together.

This analysis allows to highlight both similarities and differences among diverse operations. 

--- 

# Is there a way to extract and combine together the most meaningful information?

```{r message=FALSE, warning=FALSE, layout='Title and Content', officer::ph_location_type(type="body"), ph=officer::ph_location_type(type="body")}
budgpca <-  budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::filter(operation %in% c("Argentina MCO ABC",
                                 "Brazil ABC",
                                 "Canada ABC" ,
                                 "Colombia ABC" ,
                                 "Costa Rica ABC",
                                 "Ecuador ABC",
                                 "El Salvador ABC",
                                 "Guatemala ABC" ,
                                 "Honduras ABC",
                                 "Mexico ABC",
                                 # "Other Operations in Americas ABC"
                                 "Panama MCO ABC",
                                 "Peru ABC",
                                 # "Regional Activities AME ABC"
                                # "Regional Bureau AME ABC",
                                 "United States MCO ABC",
                                 "Venezuela ABC"            )) |>
  dplyr::group_by( operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by( operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |> 
  dplyr::select( operation, outcome_area, percent) |>
   pivot_wider(names_from = outcome_area, values_from = percent) |>
  janitor::clean_names() |>
  mutate_all(  ~coalesce(.,0)) |>
  as.data.frame()

row.names(budgpca) <- budgpca$ operation
budgpca$operation <- NULL
 
res.pca <- PCA(budgpca, graph = FALSE)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))  +
  labs(
   # x = " ",
   # y = " ",
    title = "Scree Plot for the potential dimensions",
    subtitle = "The two first factors only retain a limited part of the total variance", 
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
   unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "Y",
                           axis = "x")   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

```{r layout='Title and Content', ph=officer::ph_location_type(type="body")}
#var <- get_pca_var(res.pca)


# corrplot::corrplot(var$cos2, is.corr=FALSE)   -> mygg 
# 
# dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

# What "allocation decisions" do distinguish operations?

```{r ph=officer::ph_location_left()}
fviz_contrib(res.pca, choice = "var", axes = 1, top = 10)  +
  coord_flip() + 
  labs(
   # x = " ",
   # y = " ",
    title = "Contribution of Variables to the first dimension (horizontal)",
    subtitle = "Variables are Resources share by Outcome", 
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
   unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y") +
  theme(legend.position = "none",
        axis.text.x=element_text(angle=40,hjust=1))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

```{r ph=officer::ph_location_right()}
fviz_contrib(res.pca, choice = "var", axes = 2, top = 10)  +
  coord_flip() + 
  labs(
   # x = " ",
   # y = " ",
    title = "Contribution of Variables to the second dimension (vertical)",
    subtitle = "Variables are Resources share by Outcome", 
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
   unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y") +
  theme(legend.position = "none",
        axis.text.x=element_text(angle=40,hjust=1))  -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 

# Representing all criteria within 2 dimensions

```{r layout='Title and Content', ph=officer::ph_location_type(type="body")}
 
# fviz_pca_biplot(res.pca, 
#                 
#                 # Individuals
#                 geom.ind = "point",
#                  pointsize = "cos2", 
#                 pointshape = 21, 
#                # fill.ind = iris$Species,
#                 col.ind = "grey75",
#                 #pointsize = 2,
#                
#                 # Variables
#                 palette = "jco",
#                 addEllipses = TRUE,
#                
#                 #alpha.var ="contrib",
#                 col.var = "contrib",
#                 gradient.cols = "RdYlBu",
#                 
#                 legend.title = list(# fill = "Species",
#                                    # alpha = "Contrib", 
#                                     color = "Contrib")
#                 ) +
fviz_pca_ind(res.pca, col.ind="contrib") +
  scale_color_gradient2(low="white", mid="blue",
                        high="red", midpoint=4) +  
  
  labs(
   # x = " ",
   # y = " ",
    title = "How Resources allocations  and Operations relates?",
    subtitle = "Principal Component Analysis (PCA) ", 
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
   unhcrthemes::theme_unhcr(font_size = 12,
                           grid = FALSE, axis = FALSE)    -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

# Operation Profiles

```{r message=FALSE, warning=FALSE, layout='Title and Content', ph=officer::ph_location_type(type="body")}

# http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/117-hcpc-hierarchical-clustering-on-principal-components-essentials/
# Compute hierarchical clustering on principal components
res.hcpc <- FactoMineR::HCPC(res.pca, 
                             min	= 5, #an integer. The least possible number of clusters suggested.
                             graph = FALSE)

#To visualize the dendrogram generated by the hierarchical clustering, we’ll use the function fviz_dend() [factoextra package]:

fviz_dend(res.hcpc, 
          cex = 0.7,                     # Label size
          palette = "jco",               # Color palette see ?ggpubr::ggpar
          rect = TRUE, rect_fill = TRUE, # Add rectangle around groups
          rect_border = "jco",           # Rectangle color
          labels_track_height = 2.4      # Augment the room for labels
          )  +
  labs(
    x = " ",
    y = " ",
    title = "Profiling Operations based on Resources Allocation Strategy",
    subtitle = "Dendrogram displaying the results of Hierarchical Clustering ", 
    caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion"
  ) +
   unhcrthemes::theme_unhcr(font_size = 12,
                           grid = FALSE, axis = FALSE,
                           axis_text = FALSE)  -> dendro


#class(dendro)

dml(ggobj = dendro, fonts = list(serif = 'Lato'))
```



--- 


```{r ph=officer::ph_location_fullsize()}
 
#  Why Ecuador & Guatemala are in the same class...
budget_outcome <- budget |>
  dplyr::filter(scenario == "Detailed WOL") |>
  dplyr::group_by(operation_code, operation,   outcome_area) |>
  dplyr::summarise(cost_usd = sum(cost_usd, na.am = TRUE)) |>
  dplyr::group_by(operation_code, operation  ) |>
  dplyr::mutate( percent = cost_usd / sum(cost_usd, na.am = TRUE) ) |> 
  dplyr::filter(operation %in% c( "Ecuador ABC", "Guatemala ABC"))  
budget_outcome |>
 ggplot2::ggplot() +
  ggplot2::aes(x = outcome_area, y = percent) +
  ggplot2::geom_col(fill =  "#0072BC") +
  ggplot2::labs(y = "Percent",  x = "",
       title = "Share of Budget by Outcome | 2023",
       subtitle = "Proportion of Operating Level",
       caption = "Source: results.unhcr.org - data from report 4.6.1 - not for external diffusion") +
  ggplot2::coord_flip() + 
  ggplot2::scale_y_continuous(expand = expansion(c(0, 0.01)),
                     labels = percent) +
  unhcrthemes::theme_unhcr(font_size = 12,
                           grid = "X",
                           axis = "y" ) +
  ggplot2::facet_wrap(vars(operation))   -> mygg 

dml(ggobj = mygg, fonts = list(serif = 'Lato'))  
```







 

---

# Step 2: Reviewing Results vs Resources 

While reviewing the following charts, reflect on: 

 - Can we trust the data? Is data quality sufficient?

 - How much the main achievements and results align with Resource Allocation?

 - Can causal links be made between these changes and our interventions?

 - If no direct correlation between resource and results can be observed, do we need to build counterfactual to justify results? (_i.e. it would get worse if we were not doing anything_)

--- 



```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        thisind = "1.1 Proportion of refugees and asylum seekers registered on an individual basis.",  thisoutcome = "OA1: Access/Doc") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "1.2 Proportion of children under 5 years of age whose births have been registered with a civil authority. [SDG 16.9.1 - Tier 1]",  thisoutcome = "OA1: Access/Doc") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "1.3 Proportion of PoC with legally recognized identity documents or credentials [GCR 4.2.2].",  thisoutcome = "OA1: Access/Doc") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 

```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "2.1 Average processing time (in days) from registration to first instance asylum decision (disaggregated by individual and group procedures).",  thisoutcome = "OA2: Status") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "2.2 Proportion of individuals undergoing asylum procedures who have access to legal advice or representation.",  thisoutcome = "OA2: Status") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "2.3 Proportion of individuals undergoing asylum procedures who have access to an effective appeal mechanism after first instance rejection of their claim.",  thisoutcome = "OA2: Status") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "3.1 Extent national legal framework is in line with the 1951 Convention and/or its 1967 Protocol.",  thisoutcome = "OA3: Policy/Law") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "3.2 Extent national legal framework is in line with the 1961 Convention on the Reduction of Statelessness.",  thisoutcome = "OA3: Policy/Law") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "4.1 Proportion of PoC who know where to access available GBV services",  thisoutcome = "OA4: GBV") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "4.2 Proportion of POCs who do not accept violence against women.",  thisoutcome = "OA4: GBV") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "4.3 Proportion of survivors who are satisfied with SGBV case management services.",  thisoutcome = "OA4: GBV") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "5.1 Proportion of children at heightened risk who are supported by a Best Interests Procedure.",  thisoutcome = "OA5: Children") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "5.2 Proportion of children who participate in community-based child protection programmes",  thisoutcome = "OA5: Children") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "5.3 Proportion of unaccompanied and separated children who are in an appropriate alternative care arrangement",  thisoutcome = "OA5: Children") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "6.1 Number of PoC arrested or detained related to immigration control or legal status",  thisoutcome = "OA6: Justice") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "7.1 Extent participation of displaced and stateless people across programme phases is supported",  thisoutcome = "OA7: Community") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "7.2 Proportion of PoC who have access to effective feedback and response mechanisms.",  thisoutcome = "OA7: Community") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "7.3 Proportion (and number) of active female participants on leadership/management structures.",  thisoutcome = "OA7: Community") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "8.1 Proportion of PoC in need that receive cash transfers or in-kind assistance.",  thisoutcome = "OA8: Well-being") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "8.2 Proportion of PoC with primary reliance on clean (cooking) fuels and technology [SDG 7.1.2 Tier 1]",  thisoutcome = "OA8: Well-being") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "9.1 Proportion of PoCs living in habitable and affordable housing.",  thisoutcome = "OA9: Housing") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "9.2 Proportion of PoC that have energy to ensure lighting (close to Sphere).",  thisoutcome = "OA9: Housing") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "10.1 Proportion of children aged 9 months to five years who have received measles vaccination.",  thisoutcome = "OA10: Health") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "10.2. Proportion of births attended by skilled health personnel. [SDG 3.1.2 Tier 1]",  thisoutcome = "OA10: Health") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "11.1 Proportion of PoC enrolled in tertiary and higher education.",  thisoutcome = "OA11: Education") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "11.2 Proportion of PoC enrolled in the national education system. [GCR 2.2.1]",  thisoutcome = "OA11: Education") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "12.1 Proportion of PoC using at least basic drinking water services [linked to SDG 6.1.1].",  thisoutcome = "OA12: WASH") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "12.2 Proportion of PoC with access to a safe household toilet [linked to SDG 6.2.1].",  thisoutcome = "OA12: WASH") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "13.1. Proportion of PoC with an account at a bank or other financial institution or with a mobile-money-service provider [SDG 8.10.2 Tier 1].",  thisoutcome = "OA13: Livelihood") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "13.2. Proportion of PoC who self-report positive changes in their income compared to previous year.",  thisoutcome = "OA13: Livelihood") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "13.3 Proportion of PoC (working age) who are unemployed.",  thisoutcome = "OA13: Livelihood") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        poptype = "Refugees and Asylum-seekers",
thisind = "13.3 Proportion of PoC (working age) who are unemployed.",  thisoutcome = "OA13: Livelihood") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```


--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "14.1 Proportion of returnees with legally recognized identity documents or credentials [GCR 4.2.2].",  thisoutcome = "OA14: Return") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "15.1 Number of refugees submitted by UNHCR for resettlement.",  thisoutcome = "OA15: Resettle") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "15.2 Average processing time from resettlement submission to departure under normal priority.",  thisoutcome = "OA15: Resettle") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "15.3 Number of PoC admitted through complementary pathways from the host country.",  thisoutcome = "OA15: Resettle") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "16.1. Proportion of PoC with secure tenure rights and/or property rights to housing and/or land [revised SDG indicator 1.4.2].",  thisoutcome = "OA16: Integrate") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 


```{r ph=officer::ph_location_fullsize()}
ProgQA::result_resource(data, budget,
                        
thisind = "16.2. Proportion of PoC covered by social protection floors/systems [SDG 1.3.1].",  thisoutcome = "OA16: Integrate") -> mygg 

showtext::showtext_auto(FALSE) 
dml(ggobj = mygg, fonts = list(serif = 'Lato'))
```

--- 
